#!/usr/bin/env bash

set -e

UTILITY_PATH=$0

. "$UTILITY_PATH/../../libexec/config"
. "$UTILITY_PATH/../../libexec/args"
. "$UTILITY_PATH/../../libexec/style"
. "$UTILITY_PATH/../../libexec/functions"

interpret_args

complain_if_interrupted
load_app_config
start_output

run 'prepare' "Preparing repository"
run 'update' "Updating remote code"

# TODO
# Stop right here if app is up-to-date

run 'setup' "Setting up app"
run 'boot' 'Booting app'

finalize
